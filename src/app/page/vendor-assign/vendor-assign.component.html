<ion-content [fullscreen]="true" class="customer-assign-content">

  <!-- Assignment Form Section -->
  <ion-card class="form-card">
    <ion-card-content>
      <form [formGroup]="assignmentForm">
        <ion-grid class="form-grid">
          <!-- Employee Selection -->
          <ion-row>
            <ion-col size="12">
              <app-searchable-dropdown
                [itemIdField]="'id'"
                [placeholder]="'Select Employee'"
                [label]="'Select Employee'"
                [items]="employeesList"
                itemValueField="id"
                itemTextField="text"
                (selectionChange)="onEmployeeSelect($event)">
              </app-searchable-dropdown>
            </ion-col>
          </ion-row>

          <!-- Customer Selection -->
          <ion-row>
            <ion-col size="12">
              <app-searchable-dropdown
                [itemIdField]="'id'"
                [placeholder]="'Select Customer'"
                [label]="'Select Customer'"
                [items]="customersList"
                itemValueField="id"
                itemTextField="text"
                (selectionChange)="onCustomerSelect($event)">
              </app-searchable-dropdown>
            </ion-col>
          </ion-row>

          <!-- Assign Button -->
          <ion-row>
            <ion-col size="12">
              <ion-button
                expand="block"
                class="assign-button"
                (click)="assignEmployee()"
                [disabled]="!selectedEmployee || !selectedCustomer">
                <ion-icon slot="start" name="person-add-outline"></ion-icon>
                Assign Employee to Customer
              </ion-button>
            </ion-col>
          </ion-row>
        </ion-grid>
      </form>
    </ion-card-content>
  </ion-card>

  <!-- Assigned Mappings List -->
  <ion-card class="list-card">
    <ion-card-content>
      <div class="list-header">
        <ion-text class="list-title">Assigned Mappings</ion-text>
        <ion-text class="list-count">{{ assignments().length }} assignments</ion-text>
      </div>

      @if(assignments() && assignments().length) {
        <div class="assignments-list">
          @for (assignment of assignments(); track $index) {
            <ion-card class="assignment-item-card">
              <ion-card-content>
                <ion-grid class="assignment-item-grid">
                  <ion-row class="assignment-item-row">
                    <ion-col size="8">
                      <ion-text class="item-label">Employee</ion-text>
                      <ion-text class="item-value">{{ assignment.employeeName }}</ion-text>
                    </ion-col>
                    <ion-col size="4" class="ion-text-end">
                      <ion-button
                        fill="clear"
                        size="small"
                        color="danger"
                        (click)="deleteAssignment($index)">
                        <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
                      </ion-button>
                    </ion-col>
                  </ion-row>
                  <ion-row class="assignment-item-row">
                    <ion-col size="12">
                      <ion-text class="item-label">Customer</ion-text>
                      <ion-text class="item-value customer-value">{{ assignment.customerName }}</ion-text>
                    </ion-col>
                  </ion-row>
                </ion-grid>
              </ion-card-content>
            </ion-card>
          }
        </div>
      } @else {
        <ion-card class="empty-card">
          <ion-card-content>
            <ion-text class="empty-text">No assignments yet. Assign an employee to a customer to get started.</ion-text>
          </ion-card-content>
        </ion-card>
      }
    </ion-card-content>
  </ion-card>
</ion-content>
